<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prueba de API</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        #loading {
            display: none; /* Oculto por defecto */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>

<h1>Formulario de prueba para API</h1>

<form id="formulario">


    <label for="documento">Documento:</label>
    <input type="text" id="documento" name="documento" required>
    <br>
    <label for="nombres">Nombres:</label>
    <input type="text" id="nombres" name="nombres" readonly>
    <br>
    <label for="primer_apellido">Apellido paterno:</label>
    <input type="text" id="primer_apellido" name="primer_apellido" readonly>
    <br>
    <label for="segundo_apellido">Apellido materno:</label>
    <input type="text" id="segundo_apellido" name="segundo_apellido" readonly>
    <br>
    <label for="correo">Correo:</label>
    <input type="email" id="correo" name="correo" readonly>
    <br>
    <label for="celular">Celular:</label>
    <input type="tel" id="celular" name="celular" readonly>
    <br>
    <button type="button" id="btnObtener">Obtener Datos</button>
</form>

<img id="loading" src="loading.gif" alt="Cargando..."/> <!-- Asegúrate de tener un GIF de carga con el nombre loading.gif -->

<script>
    $(document).ready(function() {
        $('#btnObtener').on('click', function() {
            var documento = $('#documento').val();
            if (documento) {
                obtenerDatos(documento);
            } else {
                alert('Por favor, ingrese el documento.');
            }
        });
    });

    function obtenerDatos(documento) {
        // Mostrar icono de carga
        $('#loading').show();

        // Reemplaza con tu función para obtener el token
        var token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IldTTTRGIiwibmJmIjoxNzEzNDgwMDQ1LCJleHAiOjE3MTM0ODAxMDUsImlhdCI6MTcxMzQ4MDA0NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo0NDM4NiIsImF1ZCI6Imh0dHA6Ly9sb2NhbGhvc3Q6NDQzODYifQ.huzbMjL_Y8uzbqcy6Do9maprWEZmaD15Wyu0lSB_xQ4";

        $.ajax({
            url: 'https://aaec-181-176-116-93.ngrok-free.app/api/cliente/ObtenerPorDocumento?documento=' + encodeURIComponent(documento),
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function(response) {
                var data = JSON.parse(response);
                $('#nombres').val(data.Nombres || '');
                $('#primer_apellido').val(data.Onetoone_apellidopaterno || '');
                $('#segundo_apellido').val(data.Onetoone_apellidomaterno || '');
                $('#correo').val(data.Email || '');
                $('#celular').val(data.MobilePhone || '');
                $('#loading').hide(); // Ocultar icono de carga cuando la solicitud se completa
            },
            error: function(err) {
                alert('Error al obtener los datos: ' + err.responseText);
                $('#loading').hide(); // Ocultar icono de carga si hay un error
            }
        });
    }
</script>

</body>
</html>
